// Create admin account. This account can create users and add/ revoke user roles.
use admin

db.createUser(
    {
        user: "Administrator",
        // Change this password.
        pwd: "adminpassword",
        roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
    }
)

// Create a magnetometer database called "mag_db".
use mag_db

// Create custom roles for the database.
use mag_db

db.createRole(
    {
        role: "readWriteObservatories",
        privileges: [
            { resource: { db: "mag_db", collection: "observatories"}, actions: ["find", "update", "insert", "remove"] },
        ],
        roles: []
    }
)

db.createRole(
    {
        role: "writeSensorDat",
        privileges: [
            { resource: { db: "mag_db", collection: "sensorDat"}, actions: ["find", "insert"] },
        ],
        roles: []
    }
)

db.createRole(
    {
        role: "writeMagnetDat",
        privileges: [
            { resource: { db: "mag_db", collection: "magnetDat"}, actions: ["find", "insert"] },
        ],
        roles: []
    }
)

// Create users.
use mag_db

db.createUser(
    {
        user: "Obsmanager",
        // Change this password.
        pwd: "obspassword",
        roles: [ { role: "readWriteObservatories", db: "mag_db" } ]
    }
)

db.createUser(
    {
        user: "Sensorwriter",
        // Change this password.
        pwd: "senpassword",
        roles: [ { role: "writeSensorDat", db: "mag_db" } ]
    }
)

db.createUser(
    {
        user: "Magnetwriter",
        // Change this password.
        pwd: "magpassword",
        roles: [ { role: "writeMagnetDat", db: "mag_db" } ]
    }
)

db.createUser(
    {
        user: "Datreader",
        // Change this password.
        pwd: "readpassword",
        roles: [ { role: "read", db: "mag_db" } ]
    }
)

db.createUser(
    {
        user: "Readwriter",
        // Change this password.
        pwd: "rwpassword",
        roles: [ { role: "readWrite", db: "mag_db" } ]
    }
)

// Create indexes (use Datreader/Readwriter account).
use mag_db
db.sensorDat.createIndex({ "time": 1 })
